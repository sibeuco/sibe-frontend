<div class="recovery-page d-flex align-items-center justify-content-center">
    <div class="center-box col-12 col-md-10 col-lg-8 d-flex flex-column flex-md-row">
        <div class="recovery-image col-12 col-md-5 d-none d-md-block">
            <img src="assets/images/Mujer-trabajando-en-computador-UCO-1.webp" alt="Imagen recuperación de contraseña"/>
        </div>
        <div class="formulario col-12 col-md-7">
            <!-- Indicador de pasos -->
            <div class="steps-indicator d-flex justify-content-center mb-3">
                <div class="step" [class.active]="currentStep >= 1">1</div>
                <div class="step-line" [class.active]="currentStep >= 2"></div>
                <div class="step" [class.active]="currentStep >= 2">2</div>
                <div class="step-line" [class.active]="currentStep >= 3"></div>
                <div class="step" [class.active]="currentStep >= 3">3</div>
            </div>

            <!-- Paso 1: Ingresar correo -->
            <div *ngIf="currentStep === 1">
                <h1 class="titulo-recuperacion">Recuperar Contraseña</h1>
                <form class="barra"></form>
                <p class="descripcion">Ingresa el correo electrónico para recibir el código de recuperación</p>
                
                <div class="form-floating">
                    <input type="email" class="form-control" id="correoInput" [(ngModel)]="correo" placeholder="correo@ejemplo.com" (keyup.enter)="enviarCodigo()">
                    <label class="usuario-input" for="correoInput">Correo Electrónico</label>
                </div>
                
                <div style="height: 2rem;" class="text-center mt-4">
                    <span *ngIf="mensajeError" class="text-danger">{{ mensajeError }}</span>
                    <span *ngIf="mensajeExito" class="text-success">{{ mensajeExito }}</span>
                </div>
                
                <button type="button" class="btn btn-lg" (click)="enviarCodigo()" [disabled]="!correo || enviandoCodigo">
                    <span *ngIf="!enviandoCodigo">Enviar</span>
                    <span *ngIf="enviandoCodigo">
                        <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
                        Enviando...
                    </span>
                </button>
                
                <p class="mt-3">
                    <a (click)="volverLogin()" class="text-muted cursor-pointer">Volver al inicio de sesión</a>
                </p>
            </div>

            <!-- Paso 2: Ingresar código -->
            <div *ngIf="currentStep === 2">
                <h1 class="titulo-recuperacion">Verificar Código</h1>
                <form class="barra"></form>
                <p class="descripcion">Ingresa el código que enviamos a <strong>{{ correo }}</strong></p>
                
                <div class="form-floating">
                    <input type="text" class="form-control" id="codigoInput" [(ngModel)]="codigo" placeholder="123456" (keyup.enter)="validarCodigo()">
                    <label class="usuario-input" for="codigoInput">Código de Verificación</label>
                </div>
                
                <div style="height: 2rem;" class="text-center mt-4">
                    <span *ngIf="mensajeError" class="text-danger">{{ mensajeError }}</span>
                    <span *ngIf="mensajeExito" class="text-success">{{ mensajeExito }}</span>
                </div>
                
                <button type="button" class="btn btn-lg" (click)="validarCodigo()" [disabled]="!codigo || validandoCodigo">
                    <span *ngIf="!validandoCodigo">Validar Código</span>
                    <span *ngIf="validandoCodigo">
                        <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
                        Validando...
                    </span>
                </button>
                
                <p class="mt-3">
                    <a (click)="volverPaso()" class="text-muted cursor-pointer">Volver al paso anterior</a>
                </p>
            </div>

            <!-- Paso 3: Nueva contraseña -->
            <div *ngIf="currentStep === 3">
                <h1 class="titulo-recuperacion">Nueva Contraseña</h1>
                <form class="barra"></form>
                <p class="descripcion">Ingresa tu nueva contraseña</p>
                
                <div class="form-floating">
                    <input type="password" class="form-control" id="nuevaContrasenaInput" [(ngModel)]="nuevaContrasena" placeholder="Nueva contraseña">
                    <label class="usuario-input" for="nuevaContrasenaInput">Nueva Contraseña</label>
                </div>
                
                <div class="form-floating">
                    <input type="password" class="form-control" id="confirmarContrasenaInput" [(ngModel)]="confirmarContrasena" placeholder="Confirmar contraseña" (keyup.enter)="cambiarContrasena()">
                    <label class="usuario-input" for="confirmarContrasenaInput">Confirmar Contraseña</label>
                </div>
                
                <div style="height: 2rem;" class="text-center mt-4">
                    <span *ngIf="mensajeError" class="text-danger">{{ mensajeError }}</span>
                    <span *ngIf="mensajeExito" class="text-success">{{ mensajeExito }}</span>
                </div>
                
                <button type="button" class="btn btn-lg" (click)="cambiarContrasena()" [disabled]="!nuevaContrasena || !confirmarContrasena || cambiandoContrasena">
                    <span *ngIf="!cambiandoContrasena">Cambiar Contraseña</span>
                    <span *ngIf="cambiandoContrasena">
                        <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
                        Cambiando...
                    </span>
                </button>
                
                <p class="mt-3">
                    <a (click)="volverPaso()" class="text-muted cursor-pointer">Volver al paso anterior</a>
                </p>
            </div>
        </div>
    </div>
</div>
